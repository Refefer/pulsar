<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.quicksand.js"></script>
<script type="text/javascript" src="/static/js/pulsar_api.js"></script>
<script type="text/javascript" src="/static/js/pulsar.utils.js"></script>
<style>
html,body {
    margin: 0;
    padding: 0;
}
#source {
    display: none;
}

.destination {
    display: block;
    list-style-type: none;
    overflow: hidden;
}

.destination li {
    border: 1px solid blue;
    display: block;
    float: left;
    margin: 3px;
}
</style>
<script type="text/javascript">
$(function() {
    // Get the data from the url
    var hashdata = PulsarUtils.data_from_hash();
     $('#graph').css({
        height: hashdata.height || window.innerHeight
    });
    PulsarAPI.watch_key(hashdata.host, hashdata.key, function(data) {
        var sorted = data.sort(function(a,b) {
            if(a[1] < b[1]) {
                return 1;
            } else if(a[1] > b[1]) {
                return -1;
            }
            return 0;
        });
        // Clear out old data
        var $source = $('#source');
        $source.children().remove();
        for(var i = 0; i < sorted.length; i++) {
            var item = sorted[i];
            var $child = $('<li>' + item[0] + ': ' + item[1] + '</li>');
            $child.attr('data-id', item[0]);
            $source.append($child[0]);
        }
        $('#destination').quicksand('#source li');
    });
    
});
</script>
</head>
<body>
<ul id="source"></ul>
<ul id="destination" class="destination"></ul>
</body>
</html>
